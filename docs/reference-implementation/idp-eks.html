<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-reference-implementation/idp-eks/idp-eks" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Set up IDP on EKS | CNOE</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://cnoe-io.github.io/docs/reference-implementation/idp-eks"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Set up IDP on EKS | CNOE"><meta data-rh="true" name="description" content="Set up IDP on EKS"><meta data-rh="true" property="og:description" content="Set up IDP on EKS"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://cnoe-io.github.io/docs/reference-implementation/idp-eks"><link data-rh="true" rel="alternate" href="https://cnoe-io.github.io/docs/reference-implementation/idp-eks" hreflang="en"><link data-rh="true" rel="alternate" href="https://cnoe-io.github.io/docs/reference-implementation/idp-eks" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="CNOE RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="CNOE Atom Feed">






<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"><link rel="stylesheet" href="/assets/css/styles.71a6300e.css">
<script src="/assets/js/runtime~main.3fd0f9d4.js" defer="defer"></script>
<script src="/assets/js/main.e506ca1c.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="CNOE Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="CNOE Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro/cnoe">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://calendar.google.com/calendar/u/0/embed?src=064a2adfce866ccb02e61663a09f99147f22f06374e7a8994066bdc81e066986@group.calendar.google.com&amp;ctz=America/Los_Angeles" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar--calendar-link" aria-label="Community Calendar"></a><a href="https://cloud-native.slack.com/archives/C05TN9WFN5S" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar--slack-link" aria-label="Slack Channel"></a><a href="https://github.com/cnoe-io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar--github-link" aria-label="GitHub Repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/docs/intro/cnoe">Concepts</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/intro/cnoe">What is CNOE?</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/intro/idpbuilder">idpBuilder Overview</a><button aria-label="Expand sidebar category &#x27;idpBuilder Overview&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/capabilities">Technology Capabilities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/intro/technology">Technology Choices</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/intro/radar">Technology Radars</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/reference-implementation/idpbuilder">Tutorial</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/reference-implementation/idpbuilder">Set up IDP on Local Machine</a><button aria-label="Expand sidebar category &#x27;Set up IDP on Local Machine&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/reference-implementation/idp-ref">Set up IDP Reference Implementation on Local Machine</a><button aria-label="Expand sidebar category &#x27;Set up IDP Reference Implementation on Local Machine&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference-implementation/idp-stack">Create IDP Stack on Local Machine</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/reference-implementation/idp-eks">Set up IDP on EKS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference-implementation/backstage-template">Generate CNOE Backstage template</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference-implementation/plugin">Explore Backstage Plugins in CNOE</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/contribute">Contributing</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Tutorial</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Set up IDP on EKS</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Set up IDP on EKS</h1></header><div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>GitHub Repo</div><div class="admonitionContent_BuS1"><p><a href="https://github.com/cnoe-io/reference-implementation-aws" target="_blank" rel="noopener noreferrer">cnoe-io/reference-implementation-aws</a></p></div></div>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>Applications deployed in this repository are <strong>not</strong> meant or configured for production.</p></div></div>
<p><img decoding="async" loading="lazy" alt="overview" src="/assets/images/application-idp-f2aacfd5d39e181a17aee519f7a540ca.png" width="2454" height="2294" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="secret-handling">Secret handling<a href="#secret-handling" class="hash-link" aria-label="Direct link to Secret handling" title="Direct link to Secret handling">​</a></h2>
<p>Currently handled outside of repository and set via bash script. Secrets such as GitHub token and TLS private keys are stored in the <code>${REPO_ROOT}/private</code> directory.</p>
<p>We may be able to use sealed secrets with full GitOps approach in the future.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="requirements">Requirements<a href="#requirements" class="hash-link" aria-label="Direct link to Requirements" title="Direct link to Requirements">​</a></h2>
<ul>
<li>Github <strong>Organization</strong> (free to create)</li>
<li>An existing EKS cluster version (1.27+)</li>
<li>AWS CLI (2.13+)</li>
<li>Kubectl CLI (1.27+)</li>
<li>jq</li>
<li>git</li>
<li>yq</li>
<li>nc</li>
<li>curl</li>
<li>kustomize</li>
<li>node + npm (if you choose to create GitHub App via CLI)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-github-apps-for-your-github-organization">Create GitHub Apps for your GitHub Organization<a href="#create-github-apps-for-your-github-organization" class="hash-link" aria-label="Direct link to Create GitHub Apps for your GitHub Organization" title="Direct link to Create GitHub Apps for your GitHub Organization">​</a></h2>
<p>GitHub app is used to enable integration between Backstage and GitHub.
This allows you for integration actions such as automatically importing Backstage configuration such as Organization information and templates.</p>
<p>We strongly encourage you to create a <strong>dedicated GitHub organization</strong>. If you don&#x27;t have an organization for this purpose, please follow <a href="https://docs.github.com/en/organizations/collaborating-with-groups-in-organizations/creating-a-new-organization-from-scratch" target="_blank" rel="noopener noreferrer">this link</a> to create one.</p>
<p>There are two ways to create GitHub integration with Backstage. You can use the Backstage CLI, or create it manually. See <a href="https://backstage.io/docs/integrations/github/github-apps" target="_blank" rel="noopener noreferrer">this page</a> for more information on creating one manually. Once the app is created, place it under the private directory with the name <code>github-integration.yaml</code>.</p>
<p>To create one with the CLI, follow the steps below.</p>
<div class="terminal_w2Kt"><div class="terminalHeader_Kk1r"><div class="terminalControls_X6oT"><span class="terminalButton__Yhu"></span><span class="terminalButton__Yhu"></span><span class="terminalButton__Yhu"></span></div><button class="copyButton_H_xL" aria-label="Copy all commands" data-copied="false"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="terminalBody_tZ9P"><pre class="enhancedPre_UwTO"><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div><span class="prompt_iIjO">$</span><span class="command_Noto"><span class="commonCommand_AyI1">npx</span> &#x27;@backstage/cli&#x27; create-github-app ${GITHUB_ORG_NAME}</span></div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div class="comment_cniX"># If prompted, select all for permissions or select permissions listed in this page https://backstage.io/docs/integrations/github/github-apps#app-permissions</div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div class="comment_cniX"># In the browser window, allow access to all repositories then install the app.</div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div class="text_hPwK"></div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div class="comment_cniX"># move it to a &quot;private&quot; location.</div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div><span class="prompt_iIjO">$</span><span class="command_Noto"><span class="commonCommand_AyI1">mkdir</span> -p private</span></div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div><span class="prompt_iIjO">$</span><span class="command_Noto">GITHUB_APP_FILE=$(<span class="commonCommand_AyI1">ls</span> github-app-* | head -n1)</span></div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div><span class="prompt_iIjO">$</span><span class="command_Noto"><span class="commonCommand_AyI1">mv</span> ${GITHUB_APP_FILE} private/github-integration.yaml</span></div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div class="text_hPwK"></div></div></div></pre></div></div>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p><strong>The file created above contains credentials. Handle it with care.</strong></p></div></div>
<p>The rest of the installation process assumes the GitHub app credentials are available at <code>private/github-integration.yaml</code></p>
<p>If you want to delete the GitHUb application, follow <a href="https://docs.github.com/en/apps/maintaining-github-apps/deleting-a-github-app" target="_blank" rel="noopener noreferrer">these steps</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-github-token">Create a GitHub token<a href="#create-a-github-token" class="hash-link" aria-label="Direct link to Create a GitHub token" title="Direct link to Create a GitHub token">​</a></h2>
<p>A GitHub token is needed by ArgoCD to get information about repositories under your Organization.</p>
<p>The following permissions are needed:</p>
<ul>
<li>Repository access for all repositories</li>
<li>Read-only access to: Administration, Contents, and Metadata.
Get your GitHub personal access token from: <a href="https://github.com/settings/tokens?type=beta" target="_blank" rel="noopener noreferrer">https://github.com/settings/tokens?type=beta</a></li>
</ul>
<p>Once you have your token, save it under the private directory with the name <code>github-token</code>. For example:</p>
<div class="terminal_w2Kt"><div class="terminalHeader_Kk1r"><div class="terminalControls_X6oT"><span class="terminalButton__Yhu"></span><span class="terminalButton__Yhu"></span><span class="terminalButton__Yhu"></span></div><button class="copyButton_H_xL" aria-label="Copy all commands" data-copied="false"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="terminalBody_tZ9P"><pre class="enhancedPre_UwTO"><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div class="comment_cniX"># From the root of this repository.</div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div><span class="prompt_iIjO">$</span><span class="command_Noto"><span class="commonCommand_AyI1">mkdir</span> -p private</span></div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div class="comment_cniX"># paste your token</div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div><span class="prompt_iIjO">$</span><span class="command_Noto"><span class="commonCommand_AyI1">vim</span> private/github-token</span></div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div class="text_hPwK"></div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div class="comment_cniX"># example output</div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div><span class="prompt_iIjO">$</span><span class="command_Noto"><span class="commonCommand_AyI1">cat</span> private/github-token</span></div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div class="text_hPwK">github_pat_ABCDEDFEINDK...</div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div class="text_hPwK"></div></div></div></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="install">Install<a href="#install" class="hash-link" aria-label="Direct link to Install" title="Direct link to Install">​</a></h2>
<p>Follow the following steps to get started.</p>
<ol>
<li>Create GitHub apps and GitHub token as described above.</li>
<li>Create a new EKS cluster. We do not include EKS cluster in the installation module because EKS cluster requirements vary between organizations and the focus of this is integration of different projects. If you prefer, you can create a new basic cluster with the included <a href="https://github.com/cnoe-io/reference-implementation-aws/blob/main/eksctl.yaml" target="_blank" rel="noopener noreferrer"><code>eksctl.yaml</code></a> file:
<code>eksctl create -f eksctl.yaml</code>
You can get eksctl from <a href="https://eksctl.io/" target="_blank" rel="noopener noreferrer">this link</a>.</li>
<li>If you don&#x27;t have a public registered Route53 zone, <a href="https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/domain-register.html" target="_blank" rel="noopener noreferrer">register a Route53 domain</a> (be sure to use Route53 as the DNS service for the domain). We <strong>strongly encourage creating a dedicated sub domain</strong> for this. If you&#x27;d rather manage DNS yourself, you can set <code>enable_dns_management</code> in the config file.</li>
<li>Get the host zone id and put it in the config file.<!-- -->
<div class="terminal_w2Kt"><div class="terminalHeader_Kk1r"><div class="terminalControls_X6oT"><span class="terminalButton__Yhu"></span><span class="terminalButton__Yhu"></span><span class="terminalButton__Yhu"></span></div><button class="copyButton_H_xL" aria-label="Copy all commands" data-copied="false"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="terminalBody_tZ9P"><pre class="enhancedPre_UwTO"><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div><span class="prompt_iIjO">$</span><span class="command_Noto">aws route53 list-hosted-zones-by-name --dns-name &lt;YOUR_DOMAIN_NAME&gt; --query &#x27;HostedZones[0].Id&#x27; --output text | cut -d&#x27;/&#x27; -f3</span></div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div class="comment_cniX"># in the setups/config file, update the zone id.</div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div class="text_hPwK">HOSTEDZONE_ID=ZO020111111</div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div class="text_hPwK"></div></div></div></pre></div></div>
</li>
<li>Update the <a href="https://github.com/cnoe-io/reference-implementation-aws/blob/main/setups/config.yaml" target="_blank" rel="noopener noreferrer"><code>setups/config</code></a> file with your own values.</li>
<li>Run <code>setups/install.sh</code> and follow the prompts. See the section below about monitoring installation progress.</li>
<li>Once installation completes, navigate to <code>backstage.&lt;DOMAIN_NAME&gt;</code> and log in as <code>user1</code>. Password is available as a secret. You may need to wait for DNS propagation to complete to be able to login. May take ~10 minutes.<!-- -->
<div class="terminal_w2Kt"><div class="terminalHeader_Kk1r"><div class="terminalControls_X6oT"><span class="terminalButton__Yhu"></span><span class="terminalButton__Yhu"></span><span class="terminalButton__Yhu"></span></div><button class="copyButton_H_xL" aria-label="Copy all commands" data-copied="false"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="terminalBody_tZ9P"><pre class="enhancedPre_UwTO"><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div><span class="prompt_iIjO">$</span><span class="command_Noto"><span class="commonCommand_AyI1">kubectl</span> get secrets -n keycloak keycloak-user-config -o go-template=&#x27;{{range $k,$v := .data}}{{printf &quot;%s: &quot; $k}}{{if not $v}}{{$v}}{{else}}{{$v | base64decode}}{{end}}{{&quot;\n&quot;}}{{end}}&#x27;</span></div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div class="text_hPwK"></div></div></div></pre></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring-installation-progress">Monitoring installation progress<a href="#monitoring-installation-progress" class="hash-link" aria-label="Direct link to Monitoring installation progress" title="Direct link to Monitoring installation progress">​</a></h3>
<p>Components are installed as ArgoCD Applications. You can monitor installation progress by going to ArgoCD UI.</p>
<div class="terminal_w2Kt"><div class="terminalHeader_Kk1r"><div class="terminalControls_X6oT"><span class="terminalButton__Yhu"></span><span class="terminalButton__Yhu"></span><span class="terminalButton__Yhu"></span></div><button class="copyButton_H_xL" aria-label="Copy all commands" data-copied="false"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="terminalBody_tZ9P"><pre class="enhancedPre_UwTO"><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div class="comment_cniX"># Get the admin password</div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div><span class="prompt_iIjO">$</span><span class="command_Noto"><span class="commonCommand_AyI1">kubectl</span> -n argocd get secret argocd-initial-admin-secret -o jsonpath=&quot;{.data.password}&quot; | base64 -d</span></div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div class="text_hPwK"></div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div><span class="prompt_iIjO">$</span><span class="command_Noto"><span class="commonCommand_AyI1">kubectl</span> port-forward svc/argocd-server -n argocd 8081:80</span></div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div class="text_hPwK"></div></div></div></pre></div></div>
<p>Go to <a href="http://localhost:8081" target="_blank" rel="noopener noreferrer"><code>http://localhost:8081</code></a> and login with the username <code>admin</code> and password obtained above. In the UI you can look at resources created, their logs, and events.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="if-you-installed-it-without-automatic-dns-configuration">If you installed it without automatic DNS configuration.<a href="#if-you-installed-it-without-automatic-dns-configuration" class="hash-link" aria-label="Direct link to If you installed it without automatic DNS configuration." title="Direct link to If you installed it without automatic DNS configuration.">​</a></h3>
<p>If you set <code>MANAGED_DNS=false</code>, you are responsible for updating DNS records, thus external-dns is not installed. You have to set the following DNS records:</p>
<ul>
<li><code>backstage.&lt;DOMAIN_NAME&gt;</code></li>
<li><code>keycloak.&lt;DOMAIN_NAME&gt;</code></li>
<li><code>argo.&lt;DOMAIN_NAME&gt;</code></li>
<li><code>argocd.&lt;DOMAIN_NAME&gt;</code></li>
</ul>
<p>Point these records to the value returned by the following command.</p>
<div class="terminal_w2Kt"><div class="terminalHeader_Kk1r"><div class="terminalControls_X6oT"><span class="terminalButton__Yhu"></span><span class="terminalButton__Yhu"></span><span class="terminalButton__Yhu"></span></div><button class="copyButton_H_xL" aria-label="Copy all commands" data-copied="false"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="terminalBody_tZ9P"><pre class="enhancedPre_UwTO"><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div><span class="prompt_iIjO">$</span><span class="command_Noto">k get svc -n ingress-nginx ingress-nginx-controller -o jsonpath=&#x27;{.status.loadBalancer.ingress[0].hostname}&#x27;</span></div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div class="text_hPwK"></div></div></div></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="if-you-installed-it-without-cert-manager">If you installed it without Cert Manager.<a href="#if-you-installed-it-without-cert-manager" class="hash-link" aria-label="Direct link to If you installed it without Cert Manager." title="Direct link to If you installed it without Cert Manager.">​</a></h3>
<p>If you set <code>MANAGED_CERT=false</code>, you are responsible for managing TLS certs, thus cert-manager is not installed. You must <a href="https://kubernetes.io/docs/concepts/services-networking/ingress/#tls" target="_blank" rel="noopener noreferrer">create TLS secrets accordingly</a>.</p>
<p>Run the following command to find where to create secrets.</p>
<div class="terminal_w2Kt"><div class="terminalHeader_Kk1r"><div class="terminalControls_X6oT"><span class="terminalButton__Yhu"></span><span class="terminalButton__Yhu"></span><span class="terminalButton__Yhu"></span></div><button class="copyButton_H_xL" aria-label="Copy all commands" data-copied="false"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="terminalBody_tZ9P"><pre class="enhancedPre_UwTO"><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div><span class="prompt_iIjO">$</span><span class="command_Noto">output=$(<span class="commonCommand_AyI1">kubectl</span> get ingress --all-namespaces -o json | jq -r &#x27;.items[] | &quot;\(.metadata.namespace) \(.spec.rules[].host) \(.spec.tls[].secretName)&quot;&#x27;)</span></div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div><span class="prompt_iIjO">$</span><span class="command_Noto"><span class="commonCommand_AyI1">echo</span> -e &quot;Namespace \t Hostname \t TLS Secret Name&quot;</span></div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div><span class="prompt_iIjO">$</span><span class="command_Noto"><span class="commonCommand_AyI1">echo</span> -e &quot;$output&quot;</span></div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div class="text_hPwK"></div></div></div></pre></div></div>
<p>Secret format should be something like:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> backstage.&lt;DOMAIN</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> backstage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">tls.crt</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> &lt;base64 encoded cert</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">tls.key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> &lt;base64 encoded key</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> kubernetes.io/tls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-was-created">What was created?<a href="#what-was-created" class="hash-link" aria-label="Direct link to What was created?" title="Direct link to What was created?">​</a></h2>
<p>The following components are installed if you chose the full installation option.</p>
<table><thead><tr><th>Name</th><th>Version</th></tr></thead><tbody><tr><td>argo-workflows</td><td>v3.4.8</td></tr><tr><td>argocd</td><td>v2.7.6</td></tr><tr><td>aws-load-balancer-controller</td><td>v2.5.3</td></tr><tr><td>backstage</td><td>v1.16.0</td></tr><tr><td>cert-manager</td><td>v1.12.2</td></tr><tr><td>crossplane</td><td>v1.12.2</td></tr><tr><td>external-dns</td><td>v0.13.5</td></tr><tr><td>ingress-nginx</td><td>v1.8.0</td></tr><tr><td>keycloak</td><td>v22.0.0</td></tr><tr><td>external-secrets</td><td>v0.9.2</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="things-created-outside-of-the-cluster">Things created outside of the cluster<a href="#things-created-outside-of-the-cluster" class="hash-link" aria-label="Direct link to Things created outside of the cluster" title="Direct link to Things created outside of the cluster">​</a></h3>
<p>If full installation is done, you should have these DNS entries available. They all point to the Network Load Balancer.</p>
<ul>
<li><code>backstage.&lt;DOMAIN_NAME&gt;</code></li>
<li><code>argo.&lt;DOMAIN_NAME&gt;</code></li>
<li><code>keycloak.&lt;DOMAIN_NAME&gt;</code></li>
</ul>
<p>You can confirm these by querying at a register.</p>
<div class="terminal_w2Kt"><div class="terminalHeader_Kk1r"><div class="terminalControls_X6oT"><span class="terminalButton__Yhu"></span><span class="terminalButton__Yhu"></span><span class="terminalButton__Yhu"></span></div><button class="copyButton_H_xL" aria-label="Copy all commands" data-copied="false"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="terminalBody_tZ9P"><pre class="enhancedPre_UwTO"><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div><span class="prompt_iIjO">$</span><span class="command_Noto">dig A `backstage.&lt;DOMAIN_NAME&gt;` @1.1.1.1</span></div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div class="text_hPwK"></div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div><span class="prompt_iIjO">$</span><span class="command_Noto"><span class="commonCommand_AyI1">kubectl</span> get svc -n ingress-nginx</span></div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div class="text_hPwK"></div></div></div></pre></div></div>
<p>A Network Load Balancer is also created. This is managed by the AWS Load Balancer Controller and points to ingress-nginx pod. This pod is responsible for routing requests to correct places. As a result, HTTPS endpoints are created with valid certificates.</p>
<div class="terminal_w2Kt"><div class="terminalHeader_Kk1r"><div class="terminalControls_X6oT"><span class="terminalButton__Yhu"></span><span class="terminalButton__Yhu"></span><span class="terminalButton__Yhu"></span></div><button class="copyButton_H_xL" aria-label="Copy all commands" data-copied="false"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="terminalBody_tZ9P"><pre class="enhancedPre_UwTO"><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div><span class="prompt_iIjO">$</span><span class="command_Noto">openssl s_client -showcerts -servername id.&lt;DOMAIN_NAME&gt; -connect id.&lt;DOMAIN_NAME&gt;:443 &lt;&lt;&lt; &quot;Q&quot;</span></div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div><span class="prompt_iIjO">$</span><span class="command_Noto"><span class="commonCommand_AyI1">curl</span> https://backstage.&lt;DOMAIN_NAME&gt;</span></div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div class="text_hPwK"></div></div></div></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-access-the-backstage-instance">How to access the Backstage instance?<a href="#how-to-access-the-backstage-instance" class="hash-link" aria-label="Direct link to How to access the Backstage instance?" title="Direct link to How to access the Backstage instance?">​</a></h2>
<p>When you open a browser window and go to <code>https://backstage.&lt;DOMAIN_NAME&gt;</code>, you should be prompted to login.
Two users are created during the installation process: <code>user1</code> and <code>user2</code>. Their passwords are available in the keycloak namespace.</p>
<div class="terminal_w2Kt"><div class="terminalHeader_Kk1r"><div class="terminalControls_X6oT"><span class="terminalButton__Yhu"></span><span class="terminalButton__Yhu"></span><span class="terminalButton__Yhu"></span></div><button class="copyButton_H_xL" aria-label="Copy all commands" data-copied="false"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="terminalBody_tZ9P"><pre class="enhancedPre_UwTO"><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div><span class="prompt_iIjO">$</span><span class="command_Noto"><span class="commonCommand_AyI1">kubectl</span> get secrets -n keycloak keycloak-user-config -o go-template=&#x27;{{range $k,$v := .data}}{{printf &quot;%s: &quot; $k}}{{if not $v}}{{$v}}{{else}}{{$v | base64decode}}{{end}}{{&quot;\n&quot;}}{{end}}&#x27;</span></div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div class="text_hPwK"></div></div></div></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="uninstall">Uninstall<a href="#uninstall" class="hash-link" aria-label="Direct link to Uninstall" title="Direct link to Uninstall">​</a></h2>
<ol>
<li>Run <code>setups/uninstall.sh</code> and follow the prompts.</li>
<li>Remove GitHub app from your Organization by following <a href="https://docs.github.com/en/apps/maintaining-github-apps/deleting-a-github-app" target="_blank" rel="noopener noreferrer">these steps</a>.</li>
<li>Remove token from your GitHub Organization by following <a href="https://docs.github.com/en/organizations/managing-programmatic-access-to-your-organization/reviewing-and-revoking-personal-access-tokens-in-your-organization" target="_blank" rel="noopener noreferrer">these steps</a>.</li>
<li>Remove the created GitHub Organization.</li>
</ol>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Uninstall details</summary><div><div class="collapsibleContent_i85q"><h3 class="anchor anchorWithStickyNavbar_LWe7" id="resources-deleted">Resources deleted<a href="#resources-deleted" class="hash-link" aria-label="Direct link to Resources deleted" title="Direct link to Resources deleted">​</a></h3><p>Currently resources created by applications are not deleted. For example, if you have Spark Jobs running, they are not deleted and may block deletion of the spark-operator app.</p></div></div></details>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-can-you-do-in-backstage">What can you do in Backstage?<a href="#what-can-you-do-in-backstage" class="hash-link" aria-label="Direct link to What can you do in Backstage?" title="Direct link to What can you do in Backstage?">​</a></h2>
<p>See <a href="https://github.com/cnoe-io/reference-implementation-aws/blob/main/demo.md" target="_blank" rel="noopener noreferrer">this doc</a> for demos!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="possible-issues">Possible issues<a href="#possible-issues" class="hash-link" aria-label="Direct link to Possible issues" title="Direct link to Possible issues">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cert-manager">Cert-manager<a href="#cert-manager" class="hash-link" aria-label="Direct link to Cert-manager" title="Direct link to Cert-manager">​</a></h3>
<ul>
<li>by default it uses http-01 challenge. If you&#x27;d prefer using dns-01, you can update the ingress files.</li>
<li>You may get events like <code>Get &quot;http://&lt;DOMAIN&gt;/.well-known/acme-challenge/09yldI6tVRvtWVPyMfwCwsYdOCEGGVWhmb1PWzXwhXI&quot;: dial tcp: lookup &lt;DOMAIN&gt; on 10.100.0.10:53: no such host</code>. This is due to DNS propagation delay. It may take ~10 minutes.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h2>
<p>See <a href="https://github.com/cnoe-io/reference-implementation-aws/blob/main/TROUBLESHOOTING.md" target="_blank" rel="noopener noreferrer">the troubleshooting doc</a> for more information.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="creation-order-notes">Creation Order notes<a href="#creation-order-notes" class="hash-link" aria-label="Direct link to Creation Order notes" title="Direct link to Creation Order notes">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Click to expand</summary><div><div class="collapsibleContent_i85q"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="things-created-outside-of-the-cluster-with-keycloak-sso-enabled">Things created outside of the cluster with Keycloak SSO enabled.<a href="#things-created-outside-of-the-cluster-with-keycloak-sso-enabled" class="hash-link" aria-label="Direct link to Things created outside of the cluster with Keycloak SSO enabled." title="Direct link to Things created outside of the cluster with Keycloak SSO enabled.">​</a></h2><ul>
<li>
<p>Route53 records. Route53 hosted zones are not created. You must also register it if you want to be able to access through public DNS. These are managed by the external DNS controller.</p>
</li>
<li>
<p>AWS Network Load Balancer. This is just the entrance to the Kubernetes cluster. This points to the default installation of Ingress Nginx and is managed by AWS Load Balancer Controller.</p>
</li>
<li>
<p>TLS Certificates issued by Let&#x27;s Encrypt. These are managed by cert-manager based on values in Ingress. They use the production issuer which means we must be very careful with how many and often we request certificates from them. The uninstall scripts backup certificates to the <code>private</code> directory to avoid re-issuing certificates.</p>
</li>
</ul><p>These resources are controlled by Kubernetes controllers and thus should be deleted using controllers.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="keycloak-sso-with-dns-and-tls-certificates">Keycloak SSO with DNS and TLS certificates<a href="#keycloak-sso-with-dns-and-tls-certificates" class="hash-link" aria-label="Direct link to Keycloak SSO with DNS and TLS certificates" title="Direct link to Keycloak SSO with DNS and TLS certificates">​</a></h3><p>If using keycloak SSO with fully automated DNS and certificate management, it must be:</p><ol>
<li>aws-load-balancer-controller</li>
<li>ingress-nginx</li>
<li>cert-manager</li>
<li>external-dns</li>
<li>keycloak</li>
<li>The rest of stuff</li>
</ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="keycloak-sso-with-manual-dns-and-tls-certificates">Keycloak SSO with manual DNS and TLS Certificates<a href="#keycloak-sso-with-manual-dns-and-tls-certificates" class="hash-link" aria-label="Direct link to Keycloak SSO with manual DNS and TLS Certificates" title="Direct link to Keycloak SSO with manual DNS and TLS Certificates">​</a></h3><p>If using keycloak SSO but manage DNS records and certificates manually.</p><ol>
<li>aws-load-balancer-controller</li>
<li>ingress-nginx</li>
<li>The rest of stuff minus cert-manager and external-dns</li>
</ol><p>In this case, you can issue your own certs and provide them as TLS secrets as specified in the <code>spec.tls[0].secretName</code> field of Ingress objects.
You can also let NLB or ALB terminate TLS instead using the LB controller. This is not covered currently, but possible.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="no-sso">No SSO<a href="#no-sso" class="hash-link" aria-label="Direct link to No SSO" title="Direct link to No SSO">​</a></h3><p>If no SSO, no particular installation order. Eventual consistency works.</p></div></div></details></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/cnoe-io/website/tree/main/docs/reference-implementation/idp-eks/idp-eks.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/reference-implementation/idp-stack"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Create IDP Stack on Local Machine</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/reference-implementation/backstage-template"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Generate CNOE Backstage template</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#secret-handling" class="table-of-contents__link toc-highlight">Secret handling</a></li><li><a href="#requirements" class="table-of-contents__link toc-highlight">Requirements</a></li><li><a href="#create-github-apps-for-your-github-organization" class="table-of-contents__link toc-highlight">Create GitHub Apps for your GitHub Organization</a></li><li><a href="#create-a-github-token" class="table-of-contents__link toc-highlight">Create a GitHub token</a></li><li><a href="#install" class="table-of-contents__link toc-highlight">Install</a><ul><li><a href="#monitoring-installation-progress" class="table-of-contents__link toc-highlight">Monitoring installation progress</a></li><li><a href="#if-you-installed-it-without-automatic-dns-configuration" class="table-of-contents__link toc-highlight">If you installed it without automatic DNS configuration.</a></li><li><a href="#if-you-installed-it-without-cert-manager" class="table-of-contents__link toc-highlight">If you installed it without Cert Manager.</a></li></ul></li><li><a href="#what-was-created" class="table-of-contents__link toc-highlight">What was created?</a><ul><li><a href="#things-created-outside-of-the-cluster" class="table-of-contents__link toc-highlight">Things created outside of the cluster</a></li></ul></li><li><a href="#how-to-access-the-backstage-instance" class="table-of-contents__link toc-highlight">How to access the Backstage instance?</a></li><li><a href="#uninstall" class="table-of-contents__link toc-highlight">Uninstall</a><ul><li><a href="#resources-deleted" class="table-of-contents__link toc-highlight">Resources deleted</a></li></ul></li><li><a href="#what-can-you-do-in-backstage" class="table-of-contents__link toc-highlight">What can you do in Backstage?</a></li><li><a href="#possible-issues" class="table-of-contents__link toc-highlight">Possible issues</a><ul><li><a href="#cert-manager" class="table-of-contents__link toc-highlight">Cert-manager</a></li></ul></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a></li><li><a href="#creation-order-notes" class="table-of-contents__link toc-highlight">Creation Order notes</a></li><li><a href="#things-created-outside-of-the-cluster-with-keycloak-sso-enabled" class="table-of-contents__link toc-highlight">Things created outside of the cluster with Keycloak SSO enabled.</a><ul><li><a href="#keycloak-sso-with-dns-and-tls-certificates" class="table-of-contents__link toc-highlight">Keycloak SSO with DNS and TLS certificates</a></li><li><a href="#keycloak-sso-with-manual-dns-and-tls-certificates" class="table-of-contents__link toc-highlight">Keycloak SSO with manual DNS and TLS Certificates</a></li><li><a href="#no-sso" class="table-of-contents__link toc-highlight">No SSO</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">DOCS</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro/cnoe">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/contribute">Contribute</a></li></ul></div><div class="col footer__col"><div class="footer__title">SOCIAL</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://cloud-native.slack.com/archives/C05TN9WFN5S" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://calendar.google.com/calendar/u/0/embed?src=064a2adfce866ccb02e61663a09f99147f22f06374e7a8994066bdc81e066986@group.calendar.google.com&amp;ctz=America/Los_Angeles" target="_blank" rel="noopener noreferrer" class="footer__link-item">Community Meeting Calendar<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">MORE</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/cnoe-io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 CNOE</div></div></div></footer></div>
</body>
</html>