<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-reference-implementation/idp-ref/idp-ref" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Set up IDP Reference Implementation on Local Machine | CNOE</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://cnoe-io.github.io/docs/reference-implementation/idp-ref"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Set up IDP Reference Implementation on Local Machine | CNOE"><meta data-rh="true" name="description" content="Set up IDP Reference Implementation on Local Machine"><meta data-rh="true" property="og:description" content="Set up IDP Reference Implementation on Local Machine"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://cnoe-io.github.io/docs/reference-implementation/idp-ref"><link data-rh="true" rel="alternate" href="https://cnoe-io.github.io/docs/reference-implementation/idp-ref" hreflang="en"><link data-rh="true" rel="alternate" href="https://cnoe-io.github.io/docs/reference-implementation/idp-ref" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="CNOE RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="CNOE Atom Feed">






<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"><link rel="stylesheet" href="/assets/css/styles.71a6300e.css">
<script src="/assets/js/runtime~main.6f4c0e8e.js" defer="defer"></script>
<script src="/assets/js/main.36e467cf.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="CNOE Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="CNOE Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro/cnoe">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://calendar.google.com/calendar/u/0/embed?src=064a2adfce866ccb02e61663a09f99147f22f06374e7a8994066bdc81e066986@group.calendar.google.com&amp;ctz=America/Los_Angeles" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar--calendar-link" aria-label="Community Calendar"></a><a href="https://cloud-native.slack.com/archives/C05TN9WFN5S" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar--slack-link" aria-label="Slack Channel"></a><a href="https://github.com/cnoe-io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar--github-link" aria-label="GitHub Repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/docs/intro/cnoe">Concepts</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/intro/cnoe">What is CNOE?</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/intro/idpbuilder">idpBuilder Overview</a><button aria-label="Expand sidebar category &#x27;idpBuilder Overview&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/capabilities">Technology Capabilities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/intro/technology">Technology Choices</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/intro/radar">Technology Radars</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/reference-implementation/idpbuilder">Tutorial</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/reference-implementation/idpbuilder">Set up IDP on Local Machine</a><button aria-label="Expand sidebar category &#x27;Set up IDP on Local Machine&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--sublist menu__link--active" aria-current="page" tabindex="0" href="/docs/reference-implementation/idp-ref">Set up IDP Reference Implementation on Local Machine</a><button aria-label="Collapse sidebar category &#x27;Set up IDP Reference Implementation on Local Machine&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference-implementation/idp-ref/access-management">Access Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference-implementation/idp-ref/control-plane">Infrastructure Control Plane</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference-implementation/idp-ref/secrets">Secret Management</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference-implementation/idp-stack">Create IDP Stack on Local Machine</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference-implementation/idp-eks">Set up IDP on EKS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference-implementation/backstage-template">Generate CNOE Backstage template</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference-implementation/plugin">Explore Backstage Plugins in CNOE</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/contribute">Contributing</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Tutorial</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Set up IDP Reference Implementation on Local Machine</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Set up IDP Reference Implementation on Local Machine</h1></header><p>This example creates a local version of the CNOE reference implementation.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h2>
<p>Ensure you have the following tools installed on your computer.</p>
<p><strong>Required</strong></p>
<ul>
<li>Complete the <a href="/docs/reference-implementation/idpbuilder">idpbuilder installation</a>
<ul>
<li><a href="https://github.com/cnoe-io/idpbuilder/releases/latest" target="_blank" rel="noopener noreferrer">idpbuilder</a>: version <code>0.3.0</code> or later.</li>
</ul>
</li>
<li><a href="https://kubernetes.io/docs/tasks/tools/#kubectl" target="_blank" rel="noopener noreferrer">kubectl</a>: version <code>1.27</code> or later</li>
<li>Your computer should have at least 6 GB RAM allocated to Docker. If you are on Docker Desktop, see <a href="https://docs.docker.com/desktop/settings/mac/" target="_blank" rel="noopener noreferrer">this guide</a>.</li>
</ul>
<p><strong>Optional</strong></p>
<ul>
<li>AWS credentials: Access Key and secret Key. If you want to create AWS resources in one of examples below.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="installation">Installation<a href="#installation" class="hash-link" aria-label="Direct link to Installation" title="Direct link to Installation">​</a></h2>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><ul>
<li>
<p>If you&#x27;d like to run this in your web browser through Codespaces, please follow <a href="https://github.com/cnoe-io/stacks/blob/main/ref-implementation/codespaces.md" target="_blank" rel="noopener noreferrer">the instructions here</a> to install instead.</p>
</li>
<li>
<p>This example assumes that you run the reference implementation with the default port configguration of 8443 for the idpBuilder.
If you happen to configure a different host or port for the idpBuilder, the manifests in the reference example need to be updated
and be configured with the new host and port.</p>
</li>
</ul></div></div>
<p>Run the following command from the root of this repository.</p>
<div class="terminal_w2Kt"><div class="terminalHeader_Kk1r"><div class="terminalControls_X6oT"><span class="terminalButton__Yhu"></span><span class="terminalButton__Yhu"></span><span class="terminalButton__Yhu"></span></div><button class="copyButton_H_xL" aria-label="Copy all commands" data-copied="false"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="terminalBody_tZ9P"><pre class="enhancedPre_UwTO"><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div><span class="prompt_iIjO">$</span><span class="command_Noto"><span class="commonCommand_AyI1">idpbuilder</span> create --use-path-routing \</span></div><div><span class="command_Noto"><span style="margin-left:2ch">--package https://github.com/cnoe-io/stacks<!-- -->//<!-- -->ref-implementation</span></span></div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div class="text_hPwK"></div></div></div></pre></div></div>
<p>This will take ~6 minutes for everything to come up. To track the progress, you can go to the <a href="https://cnoe.localtest.me:8443/argocd/applications" target="_blank" rel="noopener noreferrer">ArgoCD UI</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-was-installed">What was installed?<a href="#what-was-installed" class="hash-link" aria-label="Direct link to What was installed?" title="Direct link to What was installed?">​</a></h3>
<ol>
<li><strong>Argo Workflows</strong> to enable workflow orchestrations.</li>
<li><strong>Backstage</strong> as the UI for software catalog and templating. Source is available <a href="https://github.com/cnoe-io/backstage-app" target="_blank" rel="noopener noreferrer">here</a>. Also check <a href="/docs/reference-implementation/idp-ref/access-management#backstage-and-kubernetes-authentication">server side authentication</a> for Backstage users access.</li>
<li><strong>Crossplane</strong>, AWS providers, and basic compositions for deploying cloud related resources (needs your credentials for this to work)</li>
<li><strong>External Secrets</strong> to generate secrets and coordinate secrets between applications.</li>
<li><strong>Keycloak</strong> as the identity provider for applications. Also check <a href="/docs/reference-implementation/idp-ref/access-management#keycloak">keycloak authentication</a> for Backstage users access.</li>
<li><strong>Spark Operator</strong> to demonstrate an example Spark workload through Backstage.</li>
</ol>
<p>If you don&#x27;t want to install a package above, you can remove the ArgoCD Application file corresponding to the package you want to remove.
For example, if you want to remove Spark Operator, you can delete <a href="https://github.com/cnoe-io/stacks/blob/main/ref-implementation/spark-operator.yaml" target="_blank" rel="noopener noreferrer">this file</a>.</p>
<div class="terminal_w2Kt"><div class="terminalHeader_Kk1r"><div class="terminalControls_X6oT"><span class="terminalButton__Yhu"></span><span class="terminalButton__Yhu"></span><span class="terminalButton__Yhu"></span></div><button class="copyButton_H_xL" aria-label="Copy all commands" data-copied="false"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="terminalBody_tZ9P"><pre class="enhancedPre_UwTO"><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div class="comment_cniX"># remove spark operator from this installation.</div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div><span class="prompt_iIjO">$</span><span class="command_Noto"><span class="commonCommand_AyI1">rm</span> examples/ref-implementation/spark-operator.yaml</span></div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div class="text_hPwK"></div></div></div></pre></div></div>
<p>The only package that cannot be removed this way is Keycloak because other packages rely on it.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="concepts">Concepts<a href="#concepts" class="hash-link" aria-label="Direct link to Concepts" title="Direct link to Concepts">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="access-management">Access Management<a href="#access-management" class="hash-link" aria-label="Direct link to Access Management" title="Direct link to Access Management">​</a></h4>
<p>This <a href="/docs/reference-implementation/idp-ref/access-management">section</a> details how access management is implemented using Keycloak as the identity provider and also explaining the current server-side authentication pattern in Backstage where all users share the same credential level.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="infrastructure-control-plane">Infrastructure Control Plane<a href="#infrastructure-control-plane" class="hash-link" aria-label="Direct link to Infrastructure Control Plane" title="Direct link to Infrastructure Control Plane">​</a></h4>
<p>The <a href="/docs/reference-implementation/idp-ref/control-plane">infrastructure control plane</a> utilizes Crossplane for AWS resource management and ArgoCD for manifest synchronization, combining GitOps and Crossplane compositions to provision and govern external resources through Kubernetes APIs. This approach allows for the enforcement of security and configuration requirements, such as tagging and encryption for S3 buckets, while also enabling developer self-service through YAML files in a Git repository.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="secrets-management">Secrets Management<a href="#secrets-management" class="hash-link" aria-label="Direct link to Secrets Management" title="Direct link to Secrets Management">​</a></h4>
<p>The <a href="/docs/reference-implementation/idp-ref/secrets">External Secrets Operator</a> is a Kubernetes Operator that retrieves secrets from external secret stores (like Vault and AWS Secrets Manager) and creates corresponding Kubernetes secrets within the cluster. The operator can manage various types of secrets including TLS certificates, with the ability to sync them between external stores and the cluster, while also providing features like automatic backup during uninstallation to avoid hitting rate limits with services like Let&#x27;s Encrypt.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="accessing-uis">Accessing UIs<a href="#accessing-uis" class="hash-link" aria-label="Direct link to Accessing UIs" title="Direct link to Accessing UIs">​</a></h3>
<ul>
<li>Argo CD: <a href="https://cnoe.localtest.me:8443/argocd" target="_blank" rel="noopener noreferrer">https://cnoe.localtest.me:8443/argocd</a></li>
<li>Argo Workflows: <a href="https://cnoe.localtest.me:8443/argo-workflows" target="_blank" rel="noopener noreferrer">https://cnoe.localtest.me:8443/argo-workflows</a></li>
<li>Backstage: <a href="https://cnoe.localtest.me:8443/" target="_blank" rel="noopener noreferrer">https://cnoe.localtest.me:8443/</a></li>
<li>Gitea: <a href="https://cnoe.localtest.me:8443/gitea" target="_blank" rel="noopener noreferrer">https://cnoe.localtest.me:8443/gitea</a></li>
<li>Keycloak: <a href="https://cnoe.localtest.me:8443/keycloak/admin/master/console/" target="_blank" rel="noopener noreferrer">https://cnoe.localtest.me:8443/keycloak/admin/master/console/</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="logging-into-backstage">Logging into Backstage<a href="#logging-into-backstage" class="hash-link" aria-label="Direct link to Logging into Backstage" title="Direct link to Logging into Backstage">​</a></h3>
<p>Once applications are ready, go to the <a href="https://cnoe.localtest.me:8443" target="_blank" rel="noopener noreferrer">backstage URL</a>.</p>
<p>Click on the Sign-In button, you will be asked to log into the Keycloak instance. There are two users set up in this
configuration, and their password can be retrieved with the following command:</p>
<div class="terminal_w2Kt"><div class="terminalHeader_Kk1r"><div class="terminalControls_X6oT"><span class="terminalButton__Yhu"></span><span class="terminalButton__Yhu"></span><span class="terminalButton__Yhu"></span></div><button class="copyButton_H_xL" aria-label="Copy all commands" data-copied="false"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="terminalBody_tZ9P"><pre class="enhancedPre_UwTO"><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div><span class="prompt_iIjO">$</span><span class="command_Noto"><span class="commonCommand_AyI1">idpbuilder</span> get secrets</span></div></div></div><div class="commandLine__eue"><div class="" style="white-space:pre-wrap"><div class="text_hPwK"></div></div></div></pre></div></div>
<p>Use the username <strong><code>user1</code></strong> and the password value given by <code>USER_PASSWORD</code> field to login to the backstage instance.
<code>user1</code> is an admin user who has access to everything in the cluster, while <code>user2</code> is a regular user with limited access.
Both users use the same password retrieved above.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="if-you-want-to-create-a-new-user-or-change-existing-users">If you want to create a new user or change existing users:<a href="#if-you-want-to-create-a-new-user-or-change-existing-users" class="hash-link" aria-label="Direct link to If you want to create a new user or change existing users:" title="Direct link to If you want to create a new user or change existing users:">​</a></h4>
<ol>
<li>Go to the <a href="https://cnoe.localtest.me:8443/keycloak/admin/master/console/" target="_blank" rel="noopener noreferrer">Keycloak UI</a>.
Login with the username <code>cnoe-admin</code>. Password is the <code>KEYCLOAK_ADMIN_PASSWORD</code> field from the command above.</li>
<li>Select <code>cnoe</code> from the realms drop down menu.</li>
<li>Select users tab.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="usecases">Usecases<a href="#usecases" class="hash-link" aria-label="Direct link to Usecases" title="Direct link to Usecases">​</a></h2>
<p>For the demonstration, we will walk through few example usecases.</p>
<ul>
<li>
<p>In the below examples, we have used the pattern of creating a new repository for every app, then having ArgoCD deploy it.
This is done for convenience and demonstration purposes only. There are alternative actions that you can use.
For example, you can create a PR to an existing repository, create a repository but not deploy them yet, etc.</p>
</li>
<li>
<p>If Backstage&#x27;s pipelining and templating mechanisms is too simple, you can use more advanced workflow engines like Tekton or Argo Workflows.
You can invoke them in Backstage templates, then track progress similar to how it was described above.</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="basic-deployment">Basic Deployment<a href="#basic-deployment" class="hash-link" aria-label="Direct link to Basic Deployment" title="Direct link to Basic Deployment">​</a></h3>
<p>Let&#x27;s start by deploying a simple application to the cluster through Backstage.</p>
<p>Click on the <code>Create...</code> button on the left, then select the <code>Create a Basic Deployment</code> template.</p>
<p><img decoding="async" loading="lazy" alt="img.png" src="/assets/images/backstage-templates-0ef5bcdba970e10a42993876c336ad0d.png" width="1144" height="821" class="img_ev3q"></p>
<p>In the next screen, type <code>demo</code> for the name field, then click Review, then Create.
Once steps run, click the Open In Catalog button to go to the entity page.</p>
<p><img decoding="async" loading="lazy" alt="img.png" src="/assets/images/basic-template-flow-007917e51d03345a93a9dc4a82cc0f2b.png" width="1076" height="415" class="img_ev3q"></p>
<p>In the demo entity page, you will notice a ArgoCD overview card associated with this entity.
You can click on the ArgoCD Application name to see more details.</p>
<p><img decoding="async" loading="lazy" alt="img.png" src="/assets/images/demo-entity-f619f94698926ee09dc5f5439c35e816.png" width="1127" height="360" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="what-just-happened">What just happened?<a href="#what-just-happened" class="hash-link" aria-label="Direct link to What just happened?" title="Direct link to What just happened?">​</a></h4>
<ol>
<li>Backstage created <a href="https://cnoe.localtest.me:8443/gitea/giteaAdmin/demo" target="_blank" rel="noopener noreferrer">a git repository</a>, then pushed templated contents to it.</li>
<li>Backstage created <a href="https://cnoe.localtest.me:8443/argocd/applications/argocd/demo?" target="_blank" rel="noopener noreferrer">an ArgoCD Application</a> and pointed it to the git repository.</li>
<li>Backstage registered the application as <a href="https://cnoe.localtest.me:8443/gitea/giteaAdmin/demo/src/branch/main/catalog-info.yaml" target="_blank" rel="noopener noreferrer">a component</a> in Backstage.</li>
<li>ArgoCD deployed the manifests stored in the repo to the cluster.</li>
<li>Backstage retrieved application health from ArgoCD API, then displayed it.</li>
</ol>
<p><img decoding="async" loading="lazy" alt="image.png" src="/assets/images/basic-deployment-ee4ea7f4daaffe283d64a6ede6ff146e.png" width="672" height="291" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="argo-workflows-and-spark-operator">Argo Workflows and Spark Operator<a href="#argo-workflows-and-spark-operator" class="hash-link" aria-label="Direct link to Argo Workflows and Spark Operator" title="Direct link to Argo Workflows and Spark Operator">​</a></h3>
<p>In this example, we will deploy a simple Apache Spark job through Argo Workflows.</p>
<p>Click on the <code>Create...</code> button on the left, then select the <code>Basic Argo Workflow with a Spark Job</code> template.</p>
<p><img decoding="async" loading="lazy" alt="img.png" src="/assets/images/backstage-templates-spark-b8543351cda19c6d2f6222047588a7bb.png" width="1144" height="821" class="img_ev3q"></p>
<p>Type <code>demo2</code> for the name field, then click create. You will notice that the Backstage templating steps are very similar to the basic example above.
Click on the Open In Catalog button to go to the entity page.</p>
<p><img decoding="async" loading="lazy" alt="img.png" src="/assets/images/demo2-entity-5f2c59d6c7711dfb76b1909ca249f4d0.png" width="1271" height="847" class="img_ev3q"></p>
<p>Deployment processes are the same as the first example. Instead of deploying a pod, we deployed a workflow to create a Spark job.</p>
<p>In the entity page, there is a card for Argo Workflows, and it should say running or succeeded.
You can click the name in the card to go to the Argo Workflows UI to view more details about this workflow run.
When prompted to log in, click the login button under single sign on. Argo Workflows is configured to use SSO with Keycloak allowing you to login with the same credentials as Backstage login.</p>
<p>Note that Argo Workflows are not usually deployed this way. This is just an example to show you how you can integrate workflows, backstage, and spark.</p>
<p>Back in the entity page, you can view more details about Spark jobs by navigating to the Spark tab.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="application-with-cloud-resources">Application with cloud resources.<a href="#application-with-cloud-resources" class="hash-link" aria-label="Direct link to Application with cloud resources." title="Direct link to Application with cloud resources.">​</a></h3>
<p>Similar to the above, we can deploy an application with cloud resources using Backstage templates.
In this example, we will create an application with a S3 Bucket.</p>
<p>Add the Crossplane integration as discussed <a href="https://github.com/cnoe-io/stacks/blob/main/crossplane-integrations/README.md" target="_blank" rel="noopener noreferrer">here</a>.</p>
<p>Choose a template named <code>App with S3 bucket</code>, type <code>demo3</code> as the name, then choose a region to create this bucket in.</p>
<p>Once you click the create button, you will have a very similar setup as the basic example.
The only difference is we now have a resource for a S3 Bucket which is managed by Crossplane.</p>
<p>Note that Bucket is <strong>not</strong> created because Crossplane doesn&#x27;t have necessary credentials to do so.
If you&#x27;d like it to actually create a bucket, update <a href="https://github.com/cnoe-io/stacks/blob/main/crossplane-integrations/crossplane-providers/provider-secret.yaml" target="_blank" rel="noopener noreferrer">the credentials secret file</a>, then run <code>idpbuilder create --package examples/ref-implementation</code>.</p>
<p>In this example, we used Crossplane to provision resources, but you can use other cloud resource management tools such as Terraform instead.
Regardless of your tool choice, concepts are the same. We use Backstage as the templating mechanism and UI for users, then use Kubernetes API with GitOps to deploy resources.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/cnoe-io/website/tree/main/docs/reference-implementation/idp-ref/idp-ref.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/reference-implementation/idpbuilder/troubleshooting"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Troubleshooting</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/reference-implementation/idp-ref/access-management"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Access Management</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#installation" class="table-of-contents__link toc-highlight">Installation</a><ul><li><a href="#what-was-installed" class="table-of-contents__link toc-highlight">What was installed?</a></li><li><a href="#concepts" class="table-of-contents__link toc-highlight">Concepts</a></li><li><a href="#accessing-uis" class="table-of-contents__link toc-highlight">Accessing UIs</a></li><li><a href="#logging-into-backstage" class="table-of-contents__link toc-highlight">Logging into Backstage</a></li></ul></li><li><a href="#usecases" class="table-of-contents__link toc-highlight">Usecases</a><ul><li><a href="#basic-deployment" class="table-of-contents__link toc-highlight">Basic Deployment</a></li><li><a href="#argo-workflows-and-spark-operator" class="table-of-contents__link toc-highlight">Argo Workflows and Spark Operator</a></li><li><a href="#application-with-cloud-resources" class="table-of-contents__link toc-highlight">Application with cloud resources.</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">DOCS</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro/cnoe">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/contribute">Contribute</a></li></ul></div><div class="col footer__col"><div class="footer__title">SOCIAL</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://cloud-native.slack.com/archives/C05TN9WFN5S" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://calendar.google.com/calendar/u/0/embed?src=064a2adfce866ccb02e61663a09f99147f22f06374e7a8994066bdc81e066986@group.calendar.google.com&amp;ctz=America/Los_Angeles" target="_blank" rel="noopener noreferrer" class="footer__link-item">Community Meeting Calendar<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">MORE</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/cnoe-io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 CNOE</div></div></div></footer></div>
</body>
</html>