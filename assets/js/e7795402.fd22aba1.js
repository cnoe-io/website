"use strict";(self.webpackChunkcnoe=self.webpackChunkcnoe||[]).push([[5662],{3692:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>s,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"reference-implementation/idpbuilder/troubleshooting","title":"Troubleshooting","description":"Troubleshooting","source":"@site/docs/reference-implementation/idpbuilder/troubleshooting.md","sourceDirName":"reference-implementation/idpbuilder","slug":"/reference-implementation/idpbuilder/troubleshooting","permalink":"/docs/reference-implementation/idpbuilder/troubleshooting","draft":false,"unlisted":false,"editUrl":"https://github.com/cnoe-io/website/tree/main/docs/reference-implementation/idpbuilder/troubleshooting.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6,"description":"Troubleshooting","title":"Troubleshooting","index":6},"sidebar":"tutorialSidebar","previous":{"title":"Using the idpBuilder","permalink":"/docs/reference-implementation/idpbuilder/usage"},"next":{"title":"Set up IDP Reference Implementation on Local Machine","permalink":"/docs/reference-implementation/idp-ref/"}}');var o=t(4848),r=t(8453);const s={sidebar_position:6,description:"Troubleshooting",title:"Troubleshooting",index:6},a=void 0,l={},d=[{value:"Podman support",id:"podman-support",level:2},{value:"Podman rootless",id:"podman-rootless",level:3},{value:"Missing Kernel modules",id:"missing-kernel-modules",level:3},{value:"Gitea OCI registry",id:"gitea-oci-registry",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h2,{id:"podman-support",children:"Podman support"}),"\n",(0,o.jsxs)(n.p,{children:["idpBuilder comes with experimental support for ",(0,o.jsx)(n.a,{href:"https://podman.io/",children:"Podman"}),".\nAlthough idpbuilder seems to work well with podman, we currently do not have end-to-end tests or a guarantee."]}),"\n",(0,o.jsx)(n.p,{children:"To get started with Podman on MacOS, run the following:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# create a local Linux VM\n$ podman machine init \n$ podman machine start\n\n# KIND_EXPERIMENTAL_PROVIDER instructs Kind to use podman as its provider\n$ KIND_EXPERIMENTAL_PROVIDER=podman idpbuilder create\n"})}),"\n",(0,o.jsx)(n.h3,{id:"podman-rootless",children:"Podman rootless"}),"\n",(0,o.jsx)(n.p,{children:"As of podman 5.0.0, it defaults to rootless mode. idpbuilder's core packages do not require root privileges, however you may need to run it in rootful mode depending on your use cases.\nIf you need rootful behaviours, run the following command:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# verify if you are running rootful or rootless\n$ podman machine inspect | jq '.[0].Rootful'\n# https://docs.podman.io/en/stable/markdown/podman-machine-set.1.html\n$ podman machine set --rootful\n"})}),"\n",(0,o.jsx)(n.h3,{id:"missing-kernel-modules",children:"Missing Kernel modules"}),"\n",(0,o.jsx)(n.p,{children:"In some environment such as RHEL 9, idpbuilder may fail with the following error message:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"Failed to create pod sandbox: rpc error: code = Unknown desc = failed to setup network for sandbox \"\": plugin type=\"portmap\" failed (add): unable to create chain CNI-HOSTPORT-SETMARK: failed to list iptables chains: running [/usr/sbin/iptables -t nat -S --wait]: exit status 3: modprobe: ERROR: could not insert 'ip_tables': Operation not permitted\niptables v1.8.9 (legacy): can't initialize iptables table `nat': Table does not exist (do you need to insmod?)\n\n"})}),"\n",(0,o.jsx)(n.admonition,{type:"note",children:(0,o.jsx)(n.p,{children:"You may need to enable the ip_table module."})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# check if ip_table is enabled\n$ lsmod | grep ip_table\n\n# if not, enable it.\n$ sudo modprobe ip_tables\n$ echo 'ip_tables' | sudo tee -a /etc/modules-load.d/ip_tables.conf\n\n# verify it's activated\n$ lsmod | grep ip_table\n"})}),"\n",(0,o.jsx)(n.h2,{id:"gitea-oci-registry",children:"Gitea OCI registry"}),"\n",(0,o.jsx)(n.p,{children:"When using the Gitea OCI registry, you may run into issues where your client cannot pull or push images to the registry."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"podman pull gitea.cnoe.localtest.me:8443/giteaadmin/ubuntu:24.08\nTrying to pull gitea.cnoe.localtest.me:8443/giteaadmin/ubuntu:24.08...\nError: initializing source docker://gitea.cnoe.localtest.me:8443/giteaadmin/ubuntu:24.08: reading manifest 24.08 in gitea.cnoe.localtest.me:8443/giteaadmin/ubuntu: manifest unknown\n"})}),"\n",(0,o.jsx)(n.p,{children:"You may need to tell your client to not verify TLS, because the TLS certificate is self-signed and generated every time a new cluster is created."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# use the --tls-verify=0 flag if you are using podman\n$ podman pull gitea.cnoe.localtest.me:8443/giteaadmin/ubuntu:24.08 --tls-verify=0\n"})})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>a});var i=t(6540);const o={},r=i.createContext(o);function s(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);